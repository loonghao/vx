# UV Provider Manifest
# This file defines the metadata, runtimes, and dependency constraints for UV.

[provider]
name = "uv"
description = "An extremely fast Python package installer and resolver"
homepage = "https://github.com/astral-sh/uv"
repository = "https://github.com/astral-sh/uv"
ecosystem = "python"
license = "MIT OR Apache-2.0"
license_note = "Dual-licensed"

# UV - Python package installer
[[runtimes]]
name = "uv"
description = "Extremely fast Python package installer"
executable = "uv"

[runtimes.versions]
source = "github-releases"
owner = "astral-sh"
repo = "uv"
strip_v_prefix = true

# RFC 0019: Executable Layout Configuration
[runtimes.layout]
download_type = "archive"

[runtimes.layout.archive]
strip_prefix = ""
executable_paths = [
    "uv.exe",  # Windows (root directory)
    "uv"       # Unix (root directory)
]

[runtimes.platforms.windows]
executable_extensions = [".exe"]

[runtimes.platforms.unix]
executable_extensions = []

# RFC 0020: Test configuration
[runtimes.test]
timeout_ms = 30000
functional_commands = [
    { command = "{executable} --version", expect_success = true, expected_output = "uv \\d+\\.\\d+\\.\\d+", name = "version_check" },
    { command = "{executable} self version", expect_success = true, expected_output = "uv \\d+\\.\\d+\\.\\d+", name = "self_version" },
]
install_verification = [
    { command = "{executable} --version", expect_success = true },
]

# UV manages Python internally, no external dependencies required
[[runtimes.constraints]]
when = "*"
recommends = [
    { runtime = "python", version = "*", reason = "UV can manage Python automatically, but having Python installed is useful for some workflows" }
]

# UVX - Python application runner (bundled with UV)
# RFC 0026: No need for constraints.requires - automatically inferred from bundled_with
[[runtimes]]
name = "uvx"
description = "Python application runner"
executable = "uvx"
bundled_with = "uv"

[runtimes.platforms.windows]
executable_extensions = [".exe"]

[runtimes.platforms.unix]
executable_extensions = []
