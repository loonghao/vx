# MSVC Build Tools Provider Manifest
# This file defines the metadata, runtimes, and dependency constraints for MSVC.

[provider]
name = "msvc"
description = "Microsoft Visual C++ Build Tools"
homepage = "https://visualstudio.microsoft.com/visual-cpp-build-tools/"
repository = "https://github.com/microsoft/STL"
ecosystem = "system"

# MSVC is Windows-only
[provider.platforms]
os = ["windows"]

# MSVC compiler
[[runtimes]]
name = "msvc"
description = "MSVC Build Tools"
executable = "cl"
aliases = ["cl", "nmake", "vs-build-tools", "msvc-tools"]

# RFC 0018: Detection configuration
# cl.exe outputs version info without arguments but returns exit code 2
[runtimes.detection]
command = "{executable}"
pattern = "Compiler Version ([\\d.]+)"
# cl.exe returns exit code 2 when run without source files
exit_codes = [0, 2]

[runtimes.versions]
source = "vs-manifest"

[runtimes.platforms.windows]
executable_extensions = [".exe"]

# nmake is bundled with MSVC
[[runtimes]]
name = "nmake"
description = "Microsoft Program Maintenance Utility"
executable = "nmake"
bundled_with = "msvc"

[runtimes.platforms.windows]
executable_extensions = [".exe"]

# link is bundled with MSVC
[[runtimes]]
name = "link"
description = "Microsoft Linker"
executable = "link"
bundled_with = "msvc"

[runtimes.platforms.windows]
executable_extensions = [".exe"]
