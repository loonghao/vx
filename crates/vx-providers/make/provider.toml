# GNU Make Provider Manifest
# This file defines the metadata, runtimes, and dependency constraints for GNU Make.
#
# GNU Make is a system tool that should be installed via system package managers.
# vx provides a unified interface to detect and manage make installations.
#
# Consider using 'just' as a modern alternative: vx install just

[provider]
name = "make"
description = "GNU Make - A build automation tool (system package manager installation)"
homepage = "https://www.gnu.org/software/make/"
repository = "https://savannah.gnu.org/projects/make"
ecosystem = "system"


# Make
[[runtimes]]
name = "make"
aliases = ["gmake", "gnumake"]
description = "GNU Make build automation tool"
executable = "make"

# Use static versions since make is installed via system package managers
[runtimes.versions]
source = "static"
versions = ["4.4.1", "4.4", "4.3", "4.2.1", "4.2", "4.1", "4.0", "3.82", "3.81"]
default = "4.4.1"

# RFC 0018: Detection configuration
[runtimes.detection]
command = "{executable} --version"
pattern = "GNU Make ([\\d.]+)"
system_paths = ["/usr/bin/make", "/usr/local/bin/make", "C:\\Program Files\\GnuWin32\\bin\\make.exe"]

[runtimes.platforms.windows]
executable_extensions = [".exe"]

[runtimes.platforms.unix]
executable_extensions = []

# RFC 0020: Test configuration
[runtimes.test]
timeout_ms = 30000
functional_commands = [
    { command = "{executable} --version", expect_success = true, expected_output = "GNU Make", name = "version_check" },
]
install_verification = [
    { command = "{executable} --version", expect_success = true },
]

# RFC 0021: System installation strategies
[runtimes.system_install]

# Chocolatey installation (Windows)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "choco"
package = "make"
priority = 80

# winget installation (Windows)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "winget"
package = "GnuWin32.Make"
priority = 70

# Scoop installation (Windows)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "scoop"
package = "make"
priority = 75

# Homebrew installation (macOS/Linux)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "brew"
package = "make"
priority = 90

# APT installation (Debian/Ubuntu)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "apt"
package = "make"
priority = 90

# DNF installation (Fedora/RHEL)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "dnf"
package = "make"
priority = 90

# Pacman installation (Arch)
[[runtimes.system_install.strategies]]
type = "package_manager"
manager = "pacman"
package = "make"
priority = 90

# Make has no external dependencies
[[runtimes.constraints]]
when = "*"
recommends = []
